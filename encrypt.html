<!doctype html>
<html>
  <head>
    <title>Smart Templates - Encrypt</title>
   <!-- LOCAL HEAD.TXT -->

   <!-- META-KEYWORDS BEGIN -->
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width; user-scalable=0; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0;">
   <!--<meta name="viewport" content="width=device-width; initial-scale=1; maximum-scale=1; minimum-scale=1">-->
   <meta name="keywords" content="SmartTemplates, mailheader, customize, e-Mail, modification, quote, html, plain, stationery">
   <meta name="google-site-verification" content="LTKICtodcLDl0nhBl2mUiXWMJbOtmEJmhYXVAqm_mJM" />
   <meta name="description" content="SmartTemplates offers an easy way to customize Thunderbirds, SeaMonkeys and Postboxs default quote header by using templates. Templates can be created for every account as well as for global settings (for all email accounts).">
   <meta name="author" content="Axel Grude, Marky Mark DE">
   <!-- META-KEYWORDS END -->

   <!-- BASICS BEGIN -->
   <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
   <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico">
   <link rel="apple-touch-icon-precomposed" href="http://smarttemplate4.mozdev.org/img/apple-touch-icon-precomposed-57x57.png">
   <link rel="apple-touch-icon-precomposed" href="http://smarttemplate4.mozdev.org/img/apple-touch-icon-precomposed-72x72.png">
   <link rel="apple-touch-icon-precomposed" href="http://smarttemplate4.mozdev.org/img/apple-touch-icon-precomposed-114x114.png">
   <link rel="apple-touch-icon-precomposed" href="http://smarttemplate4.mozdev.org/img/apple-touch-icon-precomposed-144x144.png">
   <!-- BASICS END -->

   <!-- GLOBAL STYLESHEETS BEGIN -->
   <link rel="stylesheet" type="text/css" media="print" href="/css/print.css">
   <link rel="stylesheet" type="text/css" media="scree, all" href="/css/b-i-f.css">
   <link rel="stylesheet" type="text/css" media="screen" href="/css/media.css?v=4">
   <link rel="stylesheet" type="text/css" media="screen, all" href="/css/webFonts.css">
   <link rel="stylesheet" type="text/css" media="screen, all" href="/css/project.css?v=3">
   <link rel="stylesheet" type="text/css" media="screen, all" href="/css/project_nav.css?v=1">   
   <link rel="stylesheet" type="text/css" media="screen, all" href="/css/jqueryPlugins.css?v=3">
   <!--[if lte IE 7]>
   <link rel="stylesheet" type="text/css" media="screen, all" href="/css/ie7.css">
   <![endif]-->
   <!-- GLOBAL STYLESHEETS END -->

   <!-- JQUERY JS FRAMEWORK BEGIN -->
   <!--[if lt IE 9]>
   <script src="/js/modernizr.custom.js" charset="UTF-8"></script>
   <![endif]-->
   <script src="/js/jquery-3.7.1.min.js" charset="UTF-8"></script>
   <script src="/js/jqueryPlugins.js" charset="UTF-8"></script>
   <!-- JQUERY JS FRAMEWORK END -->

   <!-- ADDITIONAL JS BEGIN -->
   <script src="/js/environment.js" charset="UTF-8"></script>
   <script src="/js/scripts.js" charset="UTF-8"></script>
   <script src="/js/navibar.js" charset="UTF-8"></script>
   <script src="/js/ga.js" charset="UTF-8"></script>
   <script src="/js/premium.js?v=13" charset="UTF-8"></script>
   <!-- ADDITIONAL JS END -->

 </head>
<!-- END LOCAL HEAD.TXT -->

<!-- HTML_BODY.HTML -->
<body>

<noscript>
	<div class="msgBox error" id="msgBox_error">
		<h1>Our website requires JavaScript.</h1>
		The instruction how to enable JavaScript in your browser, you can find <a href="http://www.enable-javascript.com/" rel="nofollow" title="How to enable Javascript in your browser" target="_blank">here</a>.
	</div>
</noscript>

<!-- ####################### BEGIN MAIN CONTENT ########################## -->
<div id="main-content-no-nav">
<!-- PROJECT_NAV.HTML -->
<h1 class="project-name" id="content"><img src="/img/logo-pro.png" alt="SmartTemplates"></h1>

 <table id="project-navigation"> 
  <tbody id="resources" class="project-navigations">
   <tr>
    <td class="navigation-list">
     <!-- a class for media query -->
     <a class="index" href="/index.html">Home</a>
     <a class="variables" href="/variables.html">Variable Definitions</a>
     <a class="templates" href="/templates.html?jquery=on">Example Templates</a>
     <a class="screenshots" href="/screenshots.html">Screenshots</a>
     <a class="version" href="/version.html">Version History</a>
     <a class="bugs" href="/kb-main.html">Knowlegebase</a>
     <a class="faq" href="/faq.html">FAQ</a>
     <a class="bugs" href="/bugs.html">Bugs &amp; Features</a>
     <a class="premium" href="/premium.html">Premium Features</a>
     <a class="contribute" href="/contribute.html">Licenses</a>
     <a class="gdpr" href="/gdpr.html">GDPR + Impressum</a>
    </td>
		<tr id="navKB">
		 <td class="kb-nav-list navigation-list">
			 <a class="kb-nav" href="/kb-basics.html">HTML Basics</a>
			 <a class="kb-nav" href="/kb-fonts.html">Fonts</a>
			 <a class="kb-nav" href="/kb-tags.html">General Tips</a>
			 <a class="kb-nav" href="/kb-inspector.html">Troubleshooting Styles</a>
			 <a class="kb-nav" href="/support.html">Add-on Troubleshooting</a>
		 </td>
		</tr>
   </tr>
 </tbody>
</table>
<!-- END PROJECT_NAV.HTML -->



		<script type="text/javascript" src="js/encrypt.js?ver=1" charset="UTF-8"> </script>
	
		<div class="h2container">
			<h2 class="page-header" style="vertical-align:top;">License Encryption</h2>
		</div>

		<style type="text/css">
			spacer {
				width:4em;
			}
			.formContainer {
				vertical-align: top;
			}
			.formBox {
				border: 1px solid gray;
				border-top-right-radius: 1em;
				display: inline-block;
				margin-right: 1em;
				padding: 1em;
				position: relative;
			}
			.boxLabel {
				background: rgba(230,230,230,1);
				border: 1px solid gray;
				left: 1em;
				padding: 0.3em 1em;
				top: -14px; 
				position: absolute;
				cursor: pointer;
			}
			.buttonPanel {
				text-align: right;
			}
			.encryptionBox input[type=text] {
				width: 70em;
			}
			#personData input[type=text] {
				width: 20em;
			}
			.label {
				display: inline-block;
				min-width: 100px;
			}
			#maxDigits, #prefix, #keySize {
				width: 3em !important;
			}
			#licenseKey {
				font-size: 10pt;
				font-family: Consolas, Courier, monospace;
				width:95em;
				height:4em;
			}
		</style>


		<script type="text/javascript">

		// note: encryption keys have to be entered manually and are stored in a cookie
		//       as they are not for public consumption!
		const default_RSA_decryption= "494d467df07bdf71e8f83d99e73f203f08bfaa9d8345b69a0b8069aff6b35569",
				default_RSA_modulus     = "49e2f5a409ecc3c96171df82f4cb0cbf274668e713008feb6d67f0ba45058ad5",
				default_RSA_keySize = "256",
				default_RSA_maxDigits = "35",
				domain_RSA_decryption   = "",
				domain_RSA_modulus      = getCookie('domainModulo'),
				domain_RSA_keySize = "512",
				domain_RSA_maxDigits = "67";
		var		dummy = 0, key_type=0;
				
		function onPageLoad() {
			key_type = 1;
			toggleEncryption();
			var now = new Date(),
					expiryDate = addDate(now, 1,'Y'),
					txtDate = expiryDate.getFullYear() + '-' + twoDigit(expiryDate.getMonth()+1) + '-' + twoDigit(expiryDate.getDate());
			document.getElementById('expiry').value = txtDate;	
			checkCookies();
		}		

		function toggleEncryption() {
			// change to domain encryption key
			key_type = (key_type==1) ? 0 : 1;
			switch (key_type) {
				case 0:
					document.getElementById('prefix').value = 'ST-';
					document.getElementById('modulo').value = default_RSA_modulus;
					document.getElementById('decryptionKey').value = default_RSA_decryption;
					document.getElementById('keySize').value = default_RSA_keySize;
					document.getElementById('maxDigits').value = default_RSA_maxDigits;
					document.getElementById('emailLabel').textContent='Email:';
					break;
				case 1:
					document.getElementById('prefix').value = 'STD-';
					document.getElementById('email').value = '*@';
					document.getElementById('modulo').value = domain_RSA_modulus;
					document.getElementById('decryptionKey').value = domain_RSA_decryption;
					document.getElementById('keySize').value = domain_RSA_keySize;
					document.getElementById('maxDigits').value = domain_RSA_maxDigits;
					document.getElementById('emailLabel').textContent='* Domain:';
					break;
			}
			checkCookies(); // fill the correct decryption Key
		}

		/* removed from encryption script as these need to access form specific variables */
		function createKey() {
			var keySize = parseInt(document.getElementById('keySize').value, 10);
			if (keySize) {
				// encryptionExponent, decryptionExponent, modulus
				var enc = document.getElementById('encryptionKey').value,
						dec = document.getElementById('decryptionKey').value,
						mod = document.getElementById('modulo').value,
						maxD = parseInt(document.getElementById('maxDigits').value);
				setMaxDigits(maxD);
				key = new RSAKeyPair(enc, dec, mod);
				return key;
			}
			return null;
		}

		function encrypt(LicenseKey) {
			var key = createKey(),
					t1 = new Date().getTime(),
					result = encryptedString(key, LicenseKey),
					t2 = new Date().getTime();
			// txtMessages.value = "Done. Encryption took " + (t2 - t1) + " milliseconds.";
			return result;
		}

		function encryptForm() {
			var email = document.getElementById('email').value.replace("[at]","@"),
					txtDate = document.getElementById('expiry').value,
					productPrefix = document.getElementById('prefix').value,
					plainText = productPrefix + email + ':' + txtDate,
					encKey = document.getElementById('encryptionKey').value,
					encModulo = document.getElementById('modulo').value;
          
      document.getElementById('email').value = email;
			if (!encKey) {
				alert('Please enter Encryption Key!');
				return;
			}
			alert( 'Encrypting License Key: ' + plainText);
			var license = plainText.replace('@','[at]') + ';' +  encrypt(plainText);
			document.getElementById('licenseKey').value = license;
			// store decryption key in cookie
			switch (key_type) {
				case 0:
					setCookie('simpleKey', encKey, 400); 
					break;
				case 1:
					setCookie('domainKey', encKey, 400); 
					setCookie('domainModulo', encModulo, 200); 
					break;
			}
		}

		function setCookie(cname, cvalue, exdays) {
			var d = new Date();
			d.setTime(d.getTime() + (exdays*24*60*60*1000));
			var expires = "expires="+ d.toUTCString();
			document.cookie = cname + "=" + cvalue + "; " + expires;
		}


		function getCookie(cname) {
			var name = cname + "=";
			var ca = document.cookie.split(';');
			for(var i = 0; i < ca.length; i++) {
				var c = ca[i];
				while (c.charAt(0) == ' ') {
						c = c.substring(1);
				}
				if (c.indexOf(name) == 0) {
						return c.substring(name.length, c.length);
				}
			}
			return "";
		}

		function checkCookies() {
			var sKey = getCookie(key_type == 0 ? 'simpleKey' : 'domainKey');
			if (sKey != "") {
				document.getElementById('encryptionKey').value = sKey;
				if (key_type=='domainKey') {
				  var domainModulo = getCookie('domainModulo');
					document.getElementById('encryptionKey').value = domainModulo;
				}
			} 
		}
		</script>

		<p style="font-style: italic; border: 2px solid gray; padding: 0.7em; margin: 0.5em 0;">Disclaimer: this form uses a cookie to store the encryption key on your hard drive. 
			 If you use this page for encrypting a license key, you agree to the use of that cookie. 
		</p>
		<h3>Form Entry</h3>
		<form>
			<div class = "formContainer">
				<div class="formBox" id="personData">
					<span class="boxLabel">User Data</span><br>
					<span class="label">Prefix:</span> <input type="text" id="prefix"/><br>
					<span class="label" id="emailLabel">Email:</span> <input type="text" id="email"/><br>
					<span class="label">Expiry Date:</span> <input type="text" id="expiry"/>
					<div class="buttonPanel">
						<button type="button" id="btnEncrypt" onclick="encryptForm(); return false;">Encrypt!</button>
					</div>
				</div>
				<div class="encryptionBox formBox">
					<span class="boxLabel" id="infoLabel" onclick="toggleEncryption();">Encryption Info</span><br>
					<span class="label">Max Digits:</span><input type="text" id="maxDigits"/>
					<span class="label"  style="margin-left: 8em !important;">Key Size:</span><input type="text" id="keySize" />
					<br>
					<span class="label">Encryption Key:</span><input type="text" id="encryptionKey" />
					<br>
					<span class="label">Decryption Key:</span><input type="text" id="decryptionKey" />
					<br>
					<span class="label">Modulo:</span><input type="text" id="modulo" />
				</div>
			</div>
			<h4>License Key</h4>
			<p>
				<textarea id="licenseKey" rows="4" cols="65" wrap="hard"></textarea>
			</p>	
				

		</form>
		<!--</div>-->

	<script type="text/javascript">
		onPageLoad();
	</script>
	

<!--</body>-->

<!-- FOOTER.HTML -->
<script>
"use strict"; // use ECMAScript5 strict mode

  /* Apply this site specific files to <head> element */
  loadStyleSheet("footer.css");
  loadStyleSheet("navibar.css");
</script>

  <div id="footer">
   <div class="horizontalRule"></div>
    <a id="contact"></a><!-- this anchor is just an in-page jump point, DO NOT REMOVE WE USE THIS ANCHOR ON ATN -->
      <div id="mailToLink">
       You have questions / comments about SmartTemplates? Please feel free to 
       <p class="mail_link">
        <script>mailtoLine();</script><!-- Mailto Line filled by JavaScript -->
       </p>
      </div>

       <div class="attribution"><b>Attributions:</b><br>
         Flagset by  Matthias Slovig under CC, see:
        <a href="http://flags.blogpotato.de/" title="Visit Flagpotato Website" target="_blank">http://flags.blogpotato.de/</a><br>
         Fugue Icons (or based on) by Yusuke Kamiyamane under CC, see:
        <a href="http://p.yusukekamiyamane.com/" title="Visit Yusuke Kamiyamane Website" target="_blank">http://p.yusukekamiyamane.com/</a><br>
         Noia Icons (or based on) by Carles Carbonell Bernado under LGPL, see:
       <a href="http://carlitus.deviantart.com/" title="Visit Noia on Deviantart" target="_blank">http://carlitus.deviantart.com/</a>
       </div>

       <!--Special Attributions -->
       <!-- Brands Carousel (jquery) in Alphabetically Order -->
        <div id="brandsCarousel">
         <a href="https://www.7-zip.org" target="_blank" title="Visit 7-Zip Website"><img class="brands" src="/brands/50/7zip.png" height="50" width="50" alt="7-Zip"></a>
         <a href="https://addons.thunderbird.net/" target="_blank" title="Visit addons.thunderbird.net (ATN)"><img class="brands" src="/brands/50/amo.png" height="50" width="50" alt="ATN"></a>
         <a href="https://www.thunderbird.net/" target="_blank" title="Visit thunderbird.net"><img class="brands" src="/brands/50/thunderbird_102.png" height="50" width="50" alt="ATN"></a>
         <a href="https://www.betterbird.eu/" target="_blank" title="Visit Betterbird"><img class="brands" src="/brands/50/betterbird.png" height="50" width="50" alt="ATN"></a>
         <a href="https://www.android.com" target="_blank" title="Visit Android Website"><img class="brands" src="/brands/50/android.png" height="50" width="50" alt="Android"></a>
         <a href="https://bluefish.openoffice.nl/index.html" target="_blank" title="Visit Bluefish Website"><img class="brands" src="/brands/50/bluefish.png" height="50" width="50" alt="Bluefish"></a>
         <a href="https://www.creativecommons.org" target="_blank" title="Visit Creative Commons Website"><img class="brands" src="/brands/50/creativecommons.png" height="50" width="50" alt="CreativeCommons"></a>
         <a href="https://duckduckgo.com" target="_blank" title="DuckDuckGo is a search engine that does not track you"><img class="brands" src="/brands/50/duckduckgo.png" height="50" width="50" alt="DuckDuckGo"></a>
         <a href="https://www.mozilla.org/firefox/fx/" target="_blank" title="Visit Firefox Website"><img class="brands" src="/brands/50/firefox.png" height="50" width="50" alt="Firefox"></a>
         <a href="https://www.gimp.org" target="_blank" title="Visit Gimp Website"><img class="brands" src="/brands/50/gimp.png" height="50" width="50" alt="Gimp"></a>
         <a href="https://www.gnu.org" target="_blank" title="Visit GNU Website"><img class="brands" src="/brands/50/gnu.png" height="50" width="50" alt="GNU"></a>
         <a href="https://www.jquery.com" target="_blank" title="Visit jQuery.com"><img class="brands" src="/brands/50/jquery.png" height="50" width="50" alt="jQuery"></a>
         <a href="https://kompozer-web.de/en" target="_blank" title="Visit KompoZer Website"><img class="brands" src="/brands/50/kompozer.png" height="50" width="50" alt="KompoZer"></a>
         <a href="https://www.libreoffice.org/" target="_blank" title="Visit LibreOffice Website"><img class="brands" src="/brands/50/libreoffice.png" height="50" width="50" alt="LibreOffice"></a>
         <a href="https://www.linux.org" target="_blank" title="Visit Linux Website"><img class="brands" src="/brands/50/linux.png" height="50" width="50" alt="Linux"></a>
         <a href="https://developer.mozilla.org" target="_blank" title="Visit developer.mozilla.org Website"><img class="brands" src="/brands/50/mdn.png" height="50" width="50" alt="MDN"></a>
         <a href="https://www.mozilla.org/foundation/about.html" target="_blank" title="Visit Mozilla Foundation Website"><img class="brands" src="/brands/50/mozilla.png" height="50" width="50" alt="Mozilla"></a>
         <a href="https://www.notepad-plus-plus.org" target="_blank" title="Visit Notepad++ Website"><img class="brands" src="/brands/50/notepad++.png" height="50" width="50" alt="Notepad++"></a>
         <a href="https://www.opensource.org" target="_blank" title="Visit Open Source Initiative Website"><img class="brands" src="/brands/50/opensource.png" height="50" width="50" alt="OpenSource"></a>
         <a href="https://www.postbox-inc.com/" target="_blank" title="Visit PostBox Website"><img class="brands" src="/brands/50/postbox.png" height="50" width="50" alt="Postbox"></a>
         <a href="https://www.seamonkey-project.org/" target="_blank" title="Visit Seamonkey Project Website"><img class="brands" src="/brands/50/seamonkey.png" height="50" width="50" alt="Seamonkey"></a>
         <a href="https://www.tortoisesvn.net" target="_blank" title="Visit Tortoise SVN Website"><img class="brands" src="/brands/50/tortoise_svn.png" height="50" width="50" alt="Tortoise SVN"></a>
         <a href="https://www.w3.org" target="_blank" title="Visit World Wide Web Consortium Website"><img class="brands" src="/brands/50/w3c.png" height="50" width="50" alt="W3C"></a>
         <a href="https://www.w3schools.com" target="_blank" title="Visit W3Schools Website"><img class="brands" src="/brands/50/w3schools.png" height="50" width="50" alt="W3 Schools"></a>
        </div>
        <!-- END Brands Carousel -->

        <div class="copyright" id="copyright">
          <script>copyrightLine();</script><!-- Copyright Line filled by JavaScript -->
        </div>

      </div><!-- CLOSE <div id="footer"> -->
    </div><!-- CLOSE <div id="main-content-no-nav"> with the blue box -->

    <!-- Overlay Navibar -->
    <div class="outerTable" id="navbarTable">
     <table class="innerTable">
      <tbody>
       <tr class="innerTableTR">
        <td class="innerTableTD"><div class="homeButton"><a href="/index.html" target="_self" title="To our Startpage">Home</a></div></td>
        <td class="innerTableTD"><div class="historyBackButton"><a href="javascript:goBack();" title="Previous Page">Previous</a></div></td>
        <td class="innerTableTD"><div class="scrollButton"><a href="javascript:window.scrollTo(0,0);" title="Scroll to Top">Up</a></div></td>
        <td class="innerTableTD"><div class="historyFwdButton"><a href="javascript:goForward();" title="Next Page">Next</a></div></td>
        <td class="innerTableTD"><div class="printButton"><a href="javascript:window.print();" title="Print this Page">Print</a></div></td>
        <td class="innerTableTD"><div class="fontPlusButton"><a href="" onclick="resizeText(1);return false;" title="increase font size">Font +</a></div></td>
        <td class="innerTableTD"><div class="fontMinusButton"><a href="" onclick="resizeText(-1);return false;" title="reduce font size">Font -</a></div></td>
       </tr>
      </tbody>
     </table>
    </div>
    <!-- END Overlay Navibar -->

    <div id="downPusher"></div><!-- push down the black main background -->
    <!-- END FOOTER.HTML -->
  </body>  
</html>
<!-- END HTML SITES IN FOOTER.HTML -->

